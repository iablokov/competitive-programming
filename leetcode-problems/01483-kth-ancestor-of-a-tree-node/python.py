import unittest

class TreeAncestor:

    def __init__(self, n: int, parent: list[int]):
        self.jumps = [list() for _ in range(n)]
        
        # initialize jumps with parents
        for i,p in enumerate(parent): 
            if p >= 0 : self.jumps[i] = [p]

        # add parents with higher powers
        for j in range(n):
            flag = False
            for i in range(n):
                if len(self.jumps[i]) <= j : continue
                p = self.jumps[i][j]
                if p < 0 or len(self.jumps[p]) <= j : continue
                q = self.jumps[p][j]
                self.jumps[i].append(q)
                flag = True
            if not flag : break

    def getKthAncestor(self, node: int, k: int) -> int:

        # make jumps using 1-bit positions
        j = 0
        while k > 0:
            if len(self.jumps[node]) <= j : return -1
            if k % 2 == 1 : node = self.jumps[node][j]
            j += 1
            k //= 2
        
        return node

#==============================================================================

class TestSolution(unittest.TestCase):

    def test_getKthAncestor_1(self):

        n = 7
        parent   = [-1,0,0,1,1,2,2]
        queries  = [[3,1],[5,2],[6,3]]
        expected = [1,0,-1]

        tree = TreeAncestor(n, parent)
        output = [tree.getKthAncestor(node, k) for node, k in queries]
        self.assertEqual(output, expected)

    def test_getKthAncestor_6(self):

        n = 1000
        parent   = [-1,0,0,0,2,0,1,5,3,4,0,7,9,2,6,5,1,12,16,8,8,3,16,18,2,4,11,7,10,7,26,18,24,14,27,21,13,18,30,34,25,13,17,7,33,0,7,24,15,15,9,31,35,52,32,11,32,7,41,4,37,32,29,59,63,22,4,41,20,59,64,35,0,9,66,26,24,11,15,56,4,32,10,68,52,21,84,59,85,56,10,33,48,34,70,43,23,48,44,63,15,99,2,92,86,22,43,28,76,8,49,55,19,108,34,73,17,10,20,90,68,97,5,50,52,104,92,9,92,74,91,110,125,72,128,93,119,2,50,136,86,53,125,80,43,16,1,137,23,36,13,0,111,114,99,140,84,135,101,54,81,136,3,84,127,94,139,144,128,147,94,64,57,156,152,159,55,75,109,52,122,34,122,70,178,23,48,79,10,22,150,172,81,10,20,128,102,102,168,187,167,141,55,159,176,49,127,3,70,158,95,58,26,89,30,96,82,207,16,65,120,76,49,107,89,56,216,2,167,83,162,180,150,165,94,108,21,225,44,215,174,86,89,24,25,243,94,39,103,50,106,122,25,212,98,232,179,170,216,167,80,2,116,259,204,98,236,240,138,138,177,165,93,33,15,225,45,85,175,171,110,98,274,66,114,176,187,202,283,135,164,102,107,189,276,237,94,241,2,36,221,217,80,8,81,111,189,21,33,102,260,189,305,26,243,215,249,175,91,166,245,75,96,253,202,122,6,189,129,131,327,273,119,164,158,92,112,253,192,309,147,10,292,217,339,331,154,252,22,193,110,181,84,168,267,16,243,356,258,43,61,318,177,144,31,253,201,56,357,281,135,338,196,94,240,134,275,369,76,318,109,365,296,316,225,299,380,267,380,382,8,40,222,41,26,234,379,109,397,182,374,149,119,173,76,249,241,120,260,162,242,395,352,57,353,102,248,110,298,397,204,28,119,356,16,59,26,388,254,88,5,120,127,126,304,358,133,230,175,270,373,432,350,370,82,190,109,59,400,315,303,273,298,359,37,151,209,48,184,249,356,20,197,181,407,252,239,20,129,438,156,205,156,66,29,31,255,197,77,266,328,163,178,339,207,240,9,289,478,144,197,387,351,40,421,198,68,325,485,482,237,266,178,24,421,237,26,290,92,415,55,385,326,91,223,280,255,164,176,11,233,386,160,114,247,207,250,35,442,319,70,349,36,253,268,239,212,207,80,504,508,447,180,511,209,26,429,476,284,132,148,63,395,468,376,297,329,301,278,363,12,211,260,442,158,7,108,53,558,161,327,321,498,371,280,336,162,424,455,55,399,5,570,229,17,233,112,197,498,478,201,565,378,54,431,149,136,23,127,475,169,529,196,151,506,29,498,85,202,138,57,269,538,459,560,276,263,274,555,511,526,243,57,63,208,273,122,128,68,298,115,305,498,232,74,413,193,608,617,428,516,7,173,600,270,105,187,497,173,422,563,189,119,230,195,496,255,381,484,515,282,659,637,496,44,331,588,104,359,475,89,76,299,330,649,388,175,349,480,337,378,73,382,630,200,422,508,83,20,214,596,530,459,274,111,129,518,214,334,269,89,423,108,31,163,8,544,568,78,290,90,533,619,208,693,455,302,480,686,270,696,560,250,202,432,197,676,536,48,151,675,390,233,513,462,402,134,304,729,508,233,647,487,553,477,176,283,532,90,411,605,61,57,203,691,665,622,444,413,259,27,535,535,195,696,729,481,50,666,472,334,178,764,755,725,205,80,214,746,695,20,741,728,602,736,49,118,604,577,708,179,750,61,676,680,439,272,560,617,210,296,581,264,617,796,547,689,715,3,524,746,314,221,177,774,800,708,354,133,486,543,371,483,156,622,131,176,604,560,687,24,763,354,89,541,430,461,260,405,109,430,147,31,587,744,91,764,816,802,791,753,827,202,637,194,696,510,345,489,705,261,211,791,638,741,27,791,330,84,385,107,157,722,469,394,746,517,298,77,752,678,303,375,469,68,190,453,227,74,583,635,524,792,736,431,814,601,801,762,270,393,783,787,548,180,295,601,490,411,203,696,281,5,206,257,183,854,515,850,28,355,800,239,782,425,862,631,707,540,410,498,800,58,391,42,783,231,331,417,884,158,646,301,754,45,540,781,321,75,125,380,674,944,335,582,631,585,633,639,41,802,203,221,57,85,547,220,350,330,139,20,357,763,408,659,585,248,377,572,426,554,922,155,305,106,313,836,977,457,200,862,563,721,805,460,777,129,765,123,851]
        queries  = [[961,479],[800,374],[112,613],[10,31],[53,358],[746,181],[363,608],[911,745],[201,821],[116,227],[650,424],[789,11],[250,749],[142,176],[623,563],[486,100],[35,134],[389,192],[907,637],[479,707],[430,390],[111,121],[960,350],[63,134],[213,8],[226,249],[220,844],[18,779],[18,138],[18,18],[249,305],[319,527],[262,949],[468,712],[832,763],[786,1000],[225,973],[923,992],[750,716],[822,655],[763,535],[301,145],[278,131],[454,710],[682,635],[329,215],[487,523],[717,308],[182,699],[974,290],[107,134],[160,611],[647,378],[241,836],[199,521],[1,98],[826,189],[655,592],[729,51],[477,577],[573,949],[876,777],[373,846],[527,35],[839,768],[164,486],[829,303],[365,239],[169,855],[77,49],[802,166],[792,650],[730,971],[904,234],[291,247],[693,754],[406,474],[691,395],[355,471],[552,218],[33,440],[93,406],[220,626],[655,635],[123,405],[381,60],[308,25],[188,591],[37,577],[811,123],[398,508],[195,635],[730,475],[646,580],[968,30],[871,913],[678,532],[352,46],[530,436],[47,562],[905,479],[10,163],[336,563],[679,896],[688,916],[793,437],[564,699],[365,886],[41,651],[281,801],[418,395],[92,33],[894,166],[977,283],[368,212],[509,417],[95,789],[320,497],[993,547],[353,25],[167,410],[748,463],[462,16],[130,372],[335,947],[354,45],[689,250],[960,198],[191,467],[249,631],[91,857],[513,221],[76,500],[295,649],[906,575],[496,31],[133,914],[364,971],[407,869],[620,15],[229,19],[125,620],[289,158],[734,31],[384,972],[150,947],[667,607],[210,458],[588,579],[122,707],[320,582],[602,822],[535,778],[225,583],[338,490],[173,406],[590,574],[557,65],[796,69],[789,925],[401,12],[333,563],[838,1000],[616,72],[362,982],[488,191],[686,942],[39,6],[812,984],[310,836],[93,524],[540,543],[994,604],[378,411],[268,716],[239,775],[710,563],[73,740],[655,528],[202,678],[743,164],[670,797],[116,866],[765,204],[316,118],[629,436],[129,237],[164,893],[873,712],[761,768],[654,973],[639,112],[353,829],[604,771],[500,462],[543,558],[100,780],[768,780],[399,245],[553,359],[557,373],[19,30],[391,718],[155,449],[382,397],[852,218],[291,669],[176,513],[693,849],[627,921],[584,879],[963,581],[590,408],[146,509],[921,234],[709,453],[795,56],[919,423],[636,69],[272,164],[907,75],[471,448],[186,597],[323,128],[911,217],[637,424],[164,275],[745,475],[295,114],[287,501],[378,706],[550,908],[924,330],[732,756],[99,140],[186,805],[971,363],[762,962],[130,570],[601,995],[812,814],[505,332],[875,45],[416,825],[691,687],[91,52],[696,877],[658,331],[58,443],[481,680],[0,320],[775,342],[768,502],[847,442],[2,903],[909,125],[243,571],[186,273],[220,434],[349,668],[629,83],[207,508],[146,490],[589,614],[823,462],[12,263],[748,46],[999,876],[583,599],[590,821],[990,142],[536,520],[562,992],[587,318],[366,486],[869,388],[759,430],[165,563],[179,409],[52,492],[478,251],[936,658],[167,358],[219,883],[539,958],[637,890],[852,679],[365,688],[124,398],[747,608],[996,209],[654,58],[530,297],[152,765],[435,835],[463,744],[157,900],[556,248],[294,499],[671,934],[990,94],[242,457],[94,180],[284,344],[992,431],[595,986],[581,75],[149,207],[446,760],[222,712],[340,821],[774,746],[970,765],[726,486],[312,751],[974,839],[465,924],[705,306],[496,44],[435,694],[409,923],[104,385],[95,385],[772,258],[236,53],[408,345],[586,743],[747,22],[215,549],[920,931],[299,519],[393,13],[286,176],[214,207],[939,972],[71,109],[518,673],[759,947],[670,827],[426,380],[54,898],[298,909],[41,560],[486,593],[555,186],[157,825],[357,223],[124,358],[239,689],[304,53],[46,501],[980,978],[286,465],[118,908],[245,49],[927,255],[613,385],[187,510],[975,313],[124,657],[196,680],[557,389],[780,632],[834,659],[775,877],[961,915],[655,931],[959,907],[817,817],[131,869],[103,967],[222,399],[132,76],[384,854],[321,101],[790,415],[505,818],[688,130],[577,545],[278,597],[863,120],[368,357],[432,837],[316,112],[550,348],[293,391],[912,357],[230,238],[726,466],[472,61],[956,261],[315,206],[692,41],[105,93],[753,86],[726,238],[118,977],[362,849],[463,429],[443,601],[118,739],[513,586],[162,890],[965,579],[972,701],[754,514],[19,828],[740,548],[925,10],[808,97],[961,315],[666,973],[449,995],[406,909],[445,336],[277,990],[877,45],[86,627],[205,341],[579,909],[687,387],[625,353],[580,693],[467,541],[764,200],[556,818],[84,760],[837,51],[618,538],[204,516],[749,409],[894,778],[64,143],[262,501],[797,244],[298,248],[199,176],[210,290],[226,487],[240,819],[442,909],[484,258],[774,510],[392,847],[351,679],[322,346],[53,237],[235,891],[58,646],[366,461],[595,303],[795,542],[210,989],[907,409],[47,847],[789,833],[805,927],[937,913],[323,233],[388,942],[752,263],[438,4],[101,489],[539,974],[294,206],[112,797],[451,350],[941,964],[69,9],[406,595],[930,128],[787,787],[62,615],[16,485],[868,464],[846,505],[850,990],[481,522],[641,325],[500,855],[827,745],[825,514],[543,970],[908,374],[354,21],[436,848],[837,983],[594,387],[774,148],[701,355],[650,807],[225,936],[424,589],[136,288],[625,90],[141,909],[133,374],[788,749],[340,365],[305,927],[638,724],[383,141],[971,787],[36,425],[107,277],[102,699],[602,362],[4,446],[606,290],[841,579],[361,926],[380,437],[442,510],[231,246],[841,125],[684,858],[23,470],[900,27],[641,644],[499,361],[88,409],[632,856],[642,909],[542,574],[60,608],[435,892],[795,468],[852,458],[836,910],[722,585],[498,829],[18,613],[85,809],[899,84],[128,654],[226,141],[638,303],[50,132],[879,132],[725,77],[378,673],[870,515],[635,918],[209,496],[998,757],[151,267],[745,812],[475,20],[125,43],[407,526],[878,842],[630,722],[647,498],[320,26],[584,961],[623,603],[733,357],[107,756],[719,336],[595,254],[319,875],[900,344],[873,619],[347,655],[372,242],[387,144],[782,167],[961,662],[443,788],[112,890],[808,590],[948,601],[561,747],[705,707],[486,194],[539,969],[631,934],[50,502],[868,441],[335,384],[604,567],[993,620],[929,253],[863,357],[248,170],[280,580],[582,573],[985,586],[589,413],[764,321],[802,582],[374,454],[33,468],[608,32],[31,42],[737,441],[490,416],[534,883],[363,10],[115,81],[20,440],[888,797],[163,330],[205,513],[812,136],[826,714],[405,172],[37,67],[702,700],[997,518],[152,988],[692,165],[539,764],[824,404],[235,457],[61,45],[221,774],[371,306],[507,158],[358,934],[993,965],[484,13],[223,693],[304,462],[820,756],[588,942],[472,695],[185,261],[447,628],[893,758],[920,762],[731,71],[806,823],[723,270],[598,8],[847,855],[388,898],[448,10],[788,849],[644,632],[394,572],[244,419],[796,629],[472,25],[220,409],[403,550],[723,654],[153,451],[332,660],[505,45],[707,373],[293,546],[427,248],[571,564],[531,561],[437,996],[972,128],[983,56],[832,914],[779,243],[189,46],[671,128],[338,331],[723,867],[232,971],[957,682],[219,696],[843,153],[264,36],[738,533],[665,975],[706,874],[639,552],[200,353],[722,292],[172,239],[204,639],[617,206],[361,168],[660,716],[624,276],[401,340],[720,780],[853,889],[877,520],[915,555],[310,474],[587,177],[780,393],[794,260],[704,46],[861,288],[246,536],[608,74],[605,257],[797,65],[713,912],[221,284],[178,799],[77,568],[416,537],[121,285],[435,297],[825,773],[964,90],[430,54],[289,575],[144,779],[62,167],[444,436],[193,525],[763,692],[915,560],[836,809],[13,364],[595,389],[475,543],[928,298],[145,828],[420,807],[963,910],[635,981],[406,193],[301,600],[687,592],[567,963],[625,331],[960,788],[151,750],[5,362],[851,595],[565,256],[662,451],[753,540],[999,863],[287,423],[733,85],[878,696],[335,496],[624,762],[318,412],[401,529],[307,542],[116,170],[536,405],[749,929],[775,363],[805,796],[733,613],[565,592],[939,719],[604,681],[107,524],[904,877],[354,105],[883,458],[537,417],[280,321],[831,707],[123,612],[680,794],[867,613],[228,475],[579,505],[227,625],[73,290],[371,192],[364,415],[897,233],[894,309],[760,154],[64,19],[402,405],[743,751],[608,591],[899,254],[473,663],[323,869],[841,813],[865,719],[512,106],[720,580],[151,622],[115,514],[953,99],[179,338],[393,184],[396,678],[126,91],[957,161],[508,648],[411,962],[703,982],[898,568],[932,339],[724,182],[620,876],[859,30],[677,274],[716,989],[902,437],[951,450],[739,392],[635,511],[538,974],[525,649],[489,673],[322,218],[263,453],[538,203],[704,279],[744,98],[136,622],[418,717],[665,489],[816,776],[762,637],[862,72],[908,169],[497,32],[591,707],[649,878],[567,274],[802,293],[986,465],[669,697],[679,631],[381,250],[185,443],[145,873],[182,165],[773,315],[93,698],[627,928],[273,665],[987,538],[452,573],[831,922],[88,400],[141,575],[480,352],[626,979],[756,551],[376,687],[972,661],[532,113],[766,923],[777,366],[592,120],[152,256],[952,871],[304,498],[589,830],[603,154],[82,125],[862,450],[407,342],[381,683],[432,379],[819,436],[484,348],[966,819],[193,136],[895,760],[585,906],[579,44],[496,604],[450,868],[250,559],[125,569],[36,915],[164,805],[309,246],[967,478],[328,69],[300,825],[428,337],[320,954],[100,255],[377,234],[83,667],[899,763],[216,164],[597,469],[76,233],[177,838],[217,694],[550,625],[134,997],[605,247],[649,494],[640,889],[36,178],[481,354],[656,69],[536,834],[75,546],[414,780],[940,869],[823,615],[947,699],[658,937],[989,87],[269,605],[343,216],[960,973],[171,251],[379,672],[980,411],[8,300],[582,423],[920,285],[746,644],[297,653],[139,764],[425,152],[109,756],[729,392],[200,473],[528,243],[437,574],[667,413],[384,511],[136,662],[977,854],[580,847],[935,641],[859,994],[9,246],[851,571],[501,54],[906,517],[632,17],[595,541],[117,923],[818,925],[793,755],[967,393],[753,807],[433,254],[319,978],[298,466],[542,839],[266,372],[361,510],[566,767],[545,907],[759,285],[549,91],[731,423],[170,960],[890,946],[997,649],[520,495],[247,765],[693,916],[82,87],[40,777],[597,203],[776,501],[833,184],[505,353],[478,571],[429,866],[738,59],[637,924],[88,385],[629,470],[577,967],[6,48],[891,387],[496,794],[659,929],[843,535],[440,960],[834,971],[499,969],[20,977],[122,91],[851,637],[402,241],[802,429],[635,804],[241,870],[268,803],[997,463],[621,407],[628,281],[736,560],[141,44],[53,17],[738,2],[478,866],[911,513],[667,303],[48,99],[499,921],[649,974],[859,536],[783,162]]
        expected = [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,32,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,151,-1,-1,-1,-1,-1,-1,-1,-1]

        tree = TreeAncestor(n, parent)
        output = [tree.getKthAncestor(node, k) for node, k in queries]
        self.assertEqual(output, expected)


if __name__ == '__main__':
    unittest.main()
